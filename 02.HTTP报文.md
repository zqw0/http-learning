## 3.1 报文流
&emsp;&#9728;HTTP报文是在HTTP应用程序之间发送的数据块。这些数据块以一些文本形式的元信息开头，这些信息描述了报文的内容及含义，后面跟着可选数据部分。这些报文在客户端、服务器和代理之间流动。术语流入、流出、上游、下游都是用来描述报文方向的。  
### 3.1.1 报文流入源端服务器
&emsp;&#9728;HTTP使用术语流入和流出，来描述事务处理的方向。报文流入源端服务器，工作完成后，会流回用户的Agent代理中。
### 3.1.2 报文向下流动
&emsp;&#9728;无论谁发送给谁报文，报文都是向下流动。都是上游给下游发报文。比如A发送报文给B。那么A就是上游，B就是下游。反之，如果B发送报文给A。那么B就是上游，A就是下游。
## 3.2 报文组成部分
&emsp;&#9728;**所有的报文都分为两类，请求报文和响应报文**。报文分为三部分，起始行，首部，主体。
## 3.2.1 报文的语法
&emsp;&#9728;请求报文的格式如下。
```
<method> <request-URL> <version>
<headers>

<entity-body>
```
&emsp;&#9728;响应报文的格式如下。
```
<version> <status> <reason-phrase>
<headers>

<entity-body>
```
下面对各部分做一个简单概述：  
&#9728;方法：客户端希望服务器对资源执行的动作。是一个单独的词。比如GET，HEAD或POST。  
&#9728;请求URL：命名了所请求资源，或者URL路径组件的完整URL。  
&#9728;版本：报文所使用的HTTP版本，格式如下:
```
HTTP/<major>.<minor>
major主版本号和minor次版本号都是整数。
```
&#9728;状态码：这三位数字描述了请求过程中所发生的情况。每个状态码的第一位数字都用于描述状态的一般类别，成功或出错等。    
&#9728;原因短语：数字状态码的可读版本，包含了行终止序列之前的所有文本。  
&#9728;首部：可以有零个或多个首部。每个首部都包含一个名字。后面跟着一个冒号，然后是一个可选的空格，接着是一个值。最后一个是CRLF。  
&#9728;实体：实体的主体部分包含一个由任意数组组成的数据块。  
展示一个示例如下：
```
请求报文：
GET /test/hi-there.txt HTTP/1.1                     ##起始行

Accept: text/*                                                        ##首部
Host: www.joes-hardware.com

响应报文：
HTTP/1.0 200 OK                                                   ##起始行

Content-type: text/plain                                    ##首部
Content-length: 19

Hi i am zqw                                                               ##主体
```
### 3.2.2 起始行
&emsp;&#9728;所有HTTP报文都以一个起始动作作为开始。**请求报文的起始行说明了要做些什么，响应报文的起始行说明发生了什么**。
１．请求行：请求报文的起始行，称为请求行。包含一个方法和一个请求URL，这个方法描述了服务器应该执行的操作。  
２．响应行：响应报文的起始行，称为响应行。包含了响应报文使用的HTTP版本，数字状态码，以及描述操作状态的文本形式的原因短语。  
３．方法：请求的起始行以方法作为开始，方法告诉服务器要做些什么。下面给出部分方法：
```
GET                                                                               从服务器获取一份文档
HEAD                                                                            只从服务器获取文档的首部
POST                                                                            向服务器发送需要处理的数据
PUT                                                                               将请求的主体部分存储在服务器上
TRACE                                                                           对可能经过代理服务器传送到服务器上去的报文进行追踪
OPTIONS                                                                     决定可以在服务器上执行哪些方法
DELETE                                                                        从服务器上删除一份文档
```
４．状态码：方法是用来告诉服务器做什么事情，状态码则是用来告诉客户端，发生了什么事情。下面列出部分状态码。
```
整体范围                                                      已定义范围                                                                               分类
100~199                                                        100~101                                                                                  信息提示
200~299                                                        200~206                                                                                  成功
300~399                                                        300~305                                                                                  重定向
400~499                                                        400~415                                                                                  客户端错误
500~599                                                        500~505                                                                                  服务器错误
```
５．原因短语：原因短语是响应起始行中的最后一个组件。它为状态码提供了文本形式的解释。  
６．版本号：说明双方用了哪种通讯协议。  
### 3.2.3 首部
１．首部分类：  
&#9728;通用首部：既可以出现在请求报文中，也可以出现在响应报文中。可以在客户端、服务器和其他应用程序之间提供一些非常有用的通用功能。
```
Connection                                                                                                  允许客户端和服务器指定与请求响应连接有关的选项
Date                                                                                                                提供日期和时间标志，说明报文是什么时间创建的
MIME-Version                                                                                              给出发送端使用mime的版本
Trailer                                                                                                             分块传输码方式
Transfer-Encoding                                                                                     编码方式
Update                                                                                                           发送端想要升级使用新版本或协议
Via                                                                                                                    显示报文经过的中间节点
```
&#9728;请求首部：请求首部是只在请求报文中有意义的首部。用于说明是谁或什么在发送请求。请求源自何处，或者客户端的喜好能力。
```
请求的信息性首部
Client-ip                                             提供了运行客户端的机器ip地址
From                                                    提供了客户端用户的e-mail地址
Host                                                     给出了接收请求的服务器的主机名和端口号
Referer                                               提供了包含当前请求URI的文档的URL
UA-color                                            客户端显示屏与颜色有关的信息
UA-CPU                                              客户端cpu信息
UA-Disp                                              客户端屏幕信息
UA-OS                                                 客户端操作系统信息
UA-Pixels                                           客户端像素信息
User-Agent                                        将发起请求的应用程序名称告诉服务器

Accept首部
Accept                                                 告诉服务器能够发送哪些媒体类型
Accept-Encoding                             告诉服务器能够发送哪些编码方式
Accept-Charset                               告诉服务器能够发送哪些字符集
Accept-Language                           告诉服务器能够发送哪些语言
```
&#9728;响应首部：提供更多响应有关的信息。响应首部为客户端提供了一些额外信息，比如谁在发送响应，响应者的功能等。
```
Age                                                       响应持续时间
Public                                                  服务器为其资源支持的请求方法列表 
Server                                                  服务器应用程序软件的名称和版本
...
```
&#9728;实体首部：描述主体的长度和内容，或者资源自身。
```

```
&#9728;扩展首部：规范中没有定义的新首部。  
常见首部实例如下：
```
Date:Tue, 30ct 1997 02:16:03 GMT                                                                            服务器产生响应的日期
Content-length:15040                                                                                                    实体的主体部分包含了15040字节的数据
Content-type:image/gif                                                                                                  实体的主体部分是一个gif图片
Accept: image/gif, image/jpeg, text/html                                                              客户端可以接收gif图片和jpeg图片以及html
```
### 3.2.4 实体的主体部分
&emsp;&#9728;HTTP报文的第三部分是可选的实体主体部分。实体的主体是HTTP报文的负荷。就是HTTP要传输的内容。  
&emsp;&#9728;HTTP报文可以承载很多类型的数字数据：图片，视频，html文档等。





































